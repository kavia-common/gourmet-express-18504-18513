{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints for managing orders in a food delivery application, including creating orders, listing user orders, retrieving specific order details, checking order status, and tracking order progress. It leverages FastAPI framework for routing and data validation, and interacts with an in-memory database for storage.", "external_files": ["../repositories/in_memory.py", ".auth"], "external_methods": ["in_memory.InMemoryDB", "in_memory.OrderRecord", "in_memory.OrderItem", "auth.get_current_user"], "published": ["router"], "classes": [{"name": "OrderItemRequest", "description": "Data model representing a request to order a specific menu item with quantity."}, {"name": "OrderCreateRequest", "description": "Data model for creating a new order including restaurant ID and list of items."}, {"name": "OrderResponse", "description": "Data model representing the order data returned in responses, including status and ETA."}], "methods": [{"name": "float _calculate_total(restaurant_id: str, items: List[OrderItemRequest])", "description": "Calculates the total cost of an order based on menu item prices and quantities, raising exception if invalid items are provided.", "scope": "", "scopeKind": ""}, {"name": "place_order(payload: OrderCreateRequest, current_user: UserRecord = Depends(get_current_user))", "description": "API endpoint for placing a new order; creates an order record and returns order details.", "scope": "", "scopeKind": ""}, {"name": "list_my_orders(current_user: UserRecord = Depends(get_current_user))", "description": "API endpoint for listing all orders belonging to the authenticated user.", "scope": "", "scopeKind": ""}, {"name": "get_order(order_id: str, current_user: UserRecord = Depends(get_current_user))", "description": "API endpoint for retrieving details of a specific order by ID, if it belongs to the user.", "scope": "", "scopeKind": ""}, {"name": "get_order_status(order_id: str, current_user: UserRecord = Depends(get_current_user))", "description": "API endpoint for retrieving the current status and ETA of a specific order.", "scope": "", "scopeKind": ""}, {"name": "track_order(order_id: str, current_user: UserRecord = Depends(get_current_user), step: int = Query(0, ge=0, description=\"Client-provided step to simulate tracking progression\"))", "description": "Simulates tracking of an order's progress, updating status and ETA based on polling step.", "scope": "", "scopeKind": ""}], "calls": ["InMemoryDB.menu_items.get", "InMemoryDB.restaurants", "InMemoryDB.orders.get", "InMemoryDB.orders[order_id]", "InMemoryDB.orders.values()", "order.tracking_note", "order.status", "order.eta_minutes"], "search-terms": ["OrderRecord", "InMemoryDB", "orders", "place_order", "list_my_orders", "get_order", "track_order", "OrderResponse", "OrderItemRequest"], "state": 2, "file_id": 14, "knowledge_revision": 30, "git_revision": "", "ctags": [{"_type": "tag", "name": "OrderCreateRequest", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^class OrderCreateRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OrderItemRequest", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^class OrderItemRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OrderResponse", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^class OrderResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_calculate_total", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def _calculate_total(restaurant_id: str, items: List[OrderItemRequest]) -> float:$/", "language": "Python", "typeref": "typename:float", "kind": "function", "signature": "(restaurant_id: str, items: List[OrderItemRequest])"}, {"_type": "tag", "name": "eta_minutes", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    eta_minutes: int = Field(..., description=\"Estimated time remaining in minutes\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "get_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def get_order(order_id: str, current_user: UserRecord = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(order_id: str, current_user: UserRecord = Depends(get_current_user))"}, {"_type": "tag", "name": "get_order_status", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def get_order_status(order_id: str, current_user: UserRecord = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(order_id: str, current_user: UserRecord = Depends(get_current_user))"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    id: str = Field(..., description=\"Order ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "item_id", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    item_id: str = Field(..., description=\"Menu item ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderItemRequest", "scopeKind": "class"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    items: List[OrderItemRequest] = Field(..., description=\"List of items to order\")$/", "language": "Python", "typeref": "typename:List[OrderItemRequest]", "kind": "variable", "scope": "OrderCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    items: List[OrderItemRequest] = Field(..., description=\"Ordered items\")$/", "language": "Python", "typeref": "typename:List[OrderItemRequest]", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "list_my_orders", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def list_my_orders(current_user: UserRecord = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: UserRecord = Depends(get_current_user))"}, {"_type": "tag", "name": "place_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def place_order(payload: OrderCreateRequest, current_user: UserRecord = Depends(get_current_user/", "language": "Python", "kind": "function", "signature": "(payload: OrderCreateRequest, current_user: UserRecord = Depends(get_current_user))"}, {"_type": "tag", "name": "quantity", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    quantity: int = Field(..., ge=1, description=\"Quantity >= 1\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "OrderItemRequest", "scopeKind": "class"}, {"_type": "tag", "name": "restaurant_id", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    restaurant_id: str = Field(..., description=\"Restaurant ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderCreateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "restaurant_id", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    restaurant_id: str = Field(..., description=\"Restaurant ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^router = APIRouter(tags=[\"Orders\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    status: str = Field(..., description=\"Order status\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "total_amount", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    total_amount: float = Field(..., description=\"Total order amount\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "track_order", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^def track_order(order_id: str, current_user: UserRecord = Depends(get_current_user), step: int =/", "language": "Python", "kind": "function", "signature": "(order_id: str, current_user: UserRecord = Depends(get_current_user), step: int = Query(0, ge=0, description=\"Client-provided step to simulate tracking progression\"))"}, {"_type": "tag", "name": "tracking_note", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    tracking_note: str = Field(..., description=\"Latest tracking message\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}, {"_type": "tag", "name": "user_id", "path": "/home/kavia/workspace/code-generation/gourmet-express-18504-18513/food_backend_api/src/api/routers/orders.py", "pattern": "/^    user_id: str = Field(..., description=\"User ID\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OrderResponse", "scopeKind": "class"}], "hash": "2a3237b1d1b94830827ff2267574f6fb", "format-version": 4, "code-base-name": "food_backend_api", "filename": "food_backend_api/src/api/routers/orders.py", "fields": [{"name": "int eta_minutes", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str id", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str item_id", "scope": "OrderItemRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "List[OrderItemRequest] items", "scope": "OrderCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "int quantity", "scope": "OrderItemRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str restaurant_id", "scope": "OrderCreateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(tags=[\"Orders\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str status", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float total_amount", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str tracking_note", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str user_id", "scope": "OrderResponse", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"30": ""}]}